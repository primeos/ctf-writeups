# Day 11: Crypt-o-Math 3.0

## Challenge text

```
Last year's challenge was too easy? Try to solve this one, you h4x0r!

c = (a * b) % p
c=0x7E65D68F84862CEA3FCC15B966767CCAED530B87FC4061517A1497A03D2
p=0xDD8E05FF296C792D2855DB6B5331AF9D112876B41D43F73CEF3AC7425F9
b=0x7BBE3A50F28B2BA511A860A0A32AD71D4B5B93A8AE295E83350E68B57E5

finding "a" will give you the flag.
```

## Decimal numbers

c = 54522849386197268880957245236018670574669537217973664965029203474514898
p = 95569680412274326120336555225544217009989759221981789160850199934150137
b = 53377708245922405260981521346007585024834005740997354455052734150957029

## Prime test

https://www.alpertron.com.ar/ECM.HTM

- c: Not a prime (ciphertext)
- p: Is prime
- b: Is prime

## Lame attempt: WolframAlpha... :D

- c = (a * b) % p

https://www.wolframalpha.com/input/?i=solve+54522849386197268880957245236018+%3D+(x+*+53377708245922405260981521346007585024834005740997354455052734150957029)+mod+95569680412274326120336555225544217009989759221981789160850199934150137+for+x

```
a1 = 160218443982672475511558653402231788017433872016890884923940965036986769
   = 0x1736D516C5EE58219A3F3B809D9CD811F31245C9935846E56BA024061191
a2 = 255788124394946801631895208627776005027423631238872674084791164971136906
   = 0x250FB576B8851FB46CC4993752CFF30BC424CD34D52C86593A93D07A378A

x = 95569680412274326120336555225544217009989759221981789160850199934150137 n
    + 64648763570398149391222098176687571007444112794909095763090765102836632
    and n element Z

a0 = 64648763570398149391222098176687571007444112794909095763090765102836632
   = 0x95DF4B6D357908EC7B9DDC9E869BD1821FFBE5E518407719CAC7791EB98
```

No useful ASCII result...

Seems like WolframAlpha isn't always correct... :D (a0 * b) % p != c

Or I did miss something.

HV18- in HEX: 0x485631382d

## Next attempt

https://www.alpertron.com.ar/ECM.HTM

Look at last years summary (or writeups):

- https://www.hacking-lab.com/export/sites/www.hacking-lab.com/references/hackvent2017/HACKvent-2017-Summary.pdf

- c = (a * b) % p
- 0 = (a * b) % p - c % p
- 0 = (a * b - c) % p

```
1. x = 31203 092237 148810 178812 127507 761703 323636 375061 497699 755717 548622 982799 (71 digits)
     = 31203092237148810178812127507761703323636375061497699755717548622982799
     = 0x485631382D4288BB2CDF615FC4576B25BA2EE4C74F5E8598BA6BBDFAE8F
```

Worked #YAY:

https://www.rapidtables.com/convert/number/hex-to-ascii.html

```
HV18-<some gibberish>
```

Prefix is correct, the rest not :o

Wrote a small Python program to find the correct solution:

```
$ ./solution.py
x = 31203092237148810178812127507761703323636375061497699755717548622982799
b'HV18-B\x88\xbb,\xdfa_\xc4Wk%\xba.\xe4\xc7O^\x85\x98\xbak\xbd\xfa\xe8'
b'HV18-xLvY-TeNT-YgEh-wBuL-bFfz\x00\x00'
```

Flag: `HV18-xLvY-TeNT-YgEh-wBuL-bFfz`
